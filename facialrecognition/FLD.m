%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%By Shelley from NCUT?April 2nd 2011
%Email:just_for_h264@163.com
%?m????fisher?????????????????
%???????????????????????????
%?????
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%????x??y????????????
%??x??y?????????????????????
%w1?w2???????????????????
%?normrnd??????????
%normrnd?mean,omega,[row,column]?
%mean:??;omega:???
%row:?????????;column:?????????
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 
%X1 = normrnd(40,10,[200,1]);
 %Y1 = normrnd(40,10,[200,1]);
 
 XX = load('X1.mat');
 YY = load('Y1.mat');
 X1 = double(XX.X1);
 Y1 = double(YY.Y1);
 w1=[X1, Y1];
 
 %X2 = normrnd(5 ,10,[100,1]);
 %Y2 = normrnd(0 ,10,[100,1]);
 XX = load('X2.mat');
 YY = load('Y2.mat');
 X2 = double(XX.X2);
 Y2 = double(YY.Y2);
 w2=[X2, Y2];
 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%?????fisher?????
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%??????
m1=mean(w1)';
m2=mean(w2)';
%s1?s2???????????????????????
s1=zeros(2);
[row1,colum1]=size(w1);
for i=1:row1
     s1 = s1 + (w1(i,:)'-m1)*(w1(i,:)'-m1)';
end;
s2=zeros(2);
[row2,colum2]=size(w2);
for i=1:row2
     s2 = s2 + (w2(i,:)' - m2)*(w2(i,:)' - m2)';
end;
%??????????Sw
Sw=s1+s2;
%??fisher???????????w
w=inv(Sw)*(m1-m2);
%????w0
ave_m1 = w'*m1;
ave_m2 = w'*m2;
w0 = (ave_m1+ave_m2)/2;
%?????????
figure(2)
plot(X1,Y1,'.r',X2,Y2,'.b');%???????
hold on;grid;
%?????????w
x = [-40:0.1:40];
y = x*w(2)/w(1);
plot(x,y,'g')
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%???????
%??ginput??????????????10???
%????????????????????
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
for i=1:40
    [x,y]=ginput(1);
    plot(x,y,'m*');
    sample=[x,y];
    hold all
    if(sample*w - w0>0)
         disp('it belong to the first class');
    else
         disp('it belong to the second class');
    end;
end
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%